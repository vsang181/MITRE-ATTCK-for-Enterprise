# Domain Properties

Domain Properties reconnaissance is a sub-technique of Gather Victim Network Information (**MITRE ATT&CK T1590.001**) in which adversaries enumerate detailed information about the network domains owned and operated by a target organisation.  Collectible domain intelligence encompasses a broad range of administrative and operational details, including registered domain names and associated subdomains, registrar identity and registration dates, domain expiry dates, administrative and technical contact information such as email addresses and phone numbers, business addresses, and name server assignments.  This intelligence directly supports adversarial targeting decisions by revealing related assets, expanding the identified attack surface, and providing actionable contact data for social engineering operations. 

Domain property data is among the most readily accessible categories of network intelligence, as much of it is publicly mandated to be available through WHOIS registration systems governed by **ICANN (Internet Corporation for Assigned Names and Numbers)** and maintained by regional internet registries.  Where third-party cloud identity providers are in use, domain intelligence may additionally be exposed through unauthenticated public API endpoints. For example, in **Microsoft Office 365 and Azure AD (Entra ID)** environments, the **GetUserRealm** and **AutoDiscover** API endpoints can be queried without authentication to enumerate tenant domain configurations, federation settings, and the presence of on-premises versus cloud-hosted infrastructure.  Gathered domain intelligence can directly inform further reconnaissance activities (e.g., **T1596 – Search Open Technical Databases**, **T1593 – Search Open Websites/Domains**, **T1598 – Phishing for Information**), resource development (e.g., **T1583 – Acquire Infrastructure**, **T1584 – Compromise Infrastructure**), and initial access operations (e.g., **T1566 – Phishing**).

***

## Collection Vectors

Adversaries leverage a broad range of passive and active methods to enumerate domain property intelligence:

- **WHOIS Lookup Services:** WHOIS is the primary and most operationally direct source of domain property intelligence, providing publicly queryable records containing registrant details (name, organisation, contact information), registrar identity, domain creation and expiry dates, name server assignments, and registration history.  WHOIS data is accessible through command-line utilities (`whois <domain>`), web-based interfaces such as [who.is](https://who.is/) and [ICANN Lookup](https://lookup.icann.org/), and programmatic APIs such as [WhoisXML API](https://www.whoisxmlapi.com/) and [DomainTools](https://www.domaintools.com/). While GDPR and equivalent privacy regulations have resulted in the redaction of personal registrant details for many domains, name server assignments, registrar information, and registration dates remain publicly accessible in the majority of cases.
- **DNS Enumeration:** Active DNS querying using tools such as the `dig` utility (`dig DOMAIN.COM ANY`) enables adversaries to retrieve all DNS record types associated with a domain, including A, MX, TXT, CNAME, NS, and SOA records.  DNS zone transfer attempts (AXFR queries) against misconfigured authoritative name servers can retrieve complete zone file contents in a single query, exposing all subdomains, internal hostnames, and associated IP addresses within the zone.  Tools such as [Amass](https://github.com/owasp-amass/amass), [Subfinder](https://github.com/projectdiscovery/subfinder), [dnsx](https://github.com/projectdiscovery/dnsx), and [DNSDumpster](https://dnsdumpster.com/) automate comprehensive domain and subdomain enumeration at scale.
- **Microsoft Azure AD API Enumeration:** In organisations using **Microsoft Entra ID (Azure AD)**, the **AADInternals** PowerShell toolkit operationalises unauthenticated enumeration of all domains associated with a tenant using the `Get-AADIntTenantDomains` function, which queries public Microsoft APIs to retrieve the complete list of verified and unverified domains registered within the tenant.  This technique has been demonstrated to surface domains belonging to target organisations that are not discoverable through conventional tools including Amass, Subfinder, Certificate Transparency logs, SecurityTrails, Shodan, or Censys, making it a particularly high-value enumeration vector against Microsoft-centric environments.
- **Active Scanning:** Network probing tools such as [Nmap](https://nmap.org/) and web application fingerprinting utilities can be used to identify domain-associated infrastructure, resolve IP addresses from domain names, and enumerate web technologies and frameworks in use across the target's domain estate.
- **Search Engine Dorking:** Google search operators such as `site:*.domain.com -site:www.domain.com` can surface indexed subdomains and associated web content not directly linked from the primary domain, expanding the enumerated attack surface beyond what WHOIS and DNS enumeration alone reveal.
- **Certificate Transparency Logs:** Public SSL/TLS certificate transparency databases including [crt.sh](https://crt.sh/) and [Censys Certificates](https://censys.io/) index all issued certificates for a domain, revealing subdomain naming conventions, internal application hostnames, and previously undisclosed infrastructure components embedded within certificate Subject Alternative Names (SANs).

***

## Procedure Examples

### AADInternals
**AADInternals** is a publicly available PowerShell-based framework for administering, enumerating, and exploiting **Microsoft Azure Active Directory (Entra ID)** and **Office 365** environments.  The toolkit's `Get-AADIntTenantDomains` function queries public Microsoft APIs without requiring authentication to enumerate all domain names associated with a target Entra ID tenant, including primary domains, subdomains, and domains associated with subsidiary organisations registered within the same tenancy.  This capability enables adversaries to comprehensively map the full domain footprint of a Microsoft 365 organisation, including domains that may not be publicly registered or discoverable through conventional DNS enumeration techniques.  AADInternals additionally supports a broad range of post-compromise capabilities including SAML token forgery, Kerberos Silver Ticket attacks, and cloud account manipulation, making it a significant multi-purpose adversarial toolkit within Azure AD environments.
### Sandworm Team
**Sandworm Team** is a Russian GRU-affiliated APT group responsible for some of the most destructive cyberattacks on record, including **NotPetya (2017)**, **Industroyer (2016)**, and **Olympic Destroyer (2018)**. Prior to its 2019 offensive cyber operation targeting Georgian institutions, Sandworm Team conducted detailed technical reconnaissance of the **Parliament of Georgia's official internet domain**, enumerating domain properties, DNS records, and associated infrastructure to map the target's online presence and identify exploitable entry points ahead of the attack campaign.
***

## Mitigations: Pre-Compromise (MITRE M1056)

Domain property reconnaissance operates predominantly through passive queries against publicly mandated registration databases and unauthenticated cloud API endpoints, placing it largely outside the effective reach of conventional enterprise network controls.  Mitigation efforts should focus on minimising the domain intelligence available to adversaries through the following measures:

- **Enable WHOIS privacy protection:** Apply **WHOIS privacy or proxy registration services** through the domain registrar to suppress personal and organisational registrant contact details from public WHOIS records. While regulatory requirements (e.g., GDPR) have resulted in partial redaction of personal data in many registries, explicitly enabling privacy protection provides the strongest available coverage across all registrar platforms and jurisdictions.
- **Restrict DNS zone transfers:** Configure all authoritative DNS name servers to deny **AXFR (zone transfer)** requests from any source other than explicitly authorised secondary name servers. Unrestricted zone transfer permissions allow adversaries to retrieve the complete DNS zone file for a domain in a single query, exposing all subdomains and internal hostnames.
- **Enable DNSSEC:** Implement **DNSSEC (Domain Name System Security Extensions)** across all registered domains to cryptographically sign DNS records, protecting DNS integrity and preventing record spoofing or cache poisoning attacks that could redirect domain traffic to adversary-controlled infrastructure.
- **Harden Microsoft Entra ID API exposure:** Implement **Conditional Access policies** and tenant configuration hardening within **Microsoft Entra ID** to limit the information exposed through unauthenticated public API endpoints including `GetUserRealm`, `AutoDiscover`, and `GetCredentialType`. Regularly audit the domains registered within the Entra ID tenant to ensure only currently required and actively managed domains are verified and retained.
- **Domain monitoring and lookalike detection:** Deploy continuous domain monitoring services such as [RiskIQ (Microsoft Defender Threat Intelligence)](https://www.microsoft.com/en-us/security/business/siem-and-xdr/microsoft-defender-threat-intelligence) and [DomainTools Iris Detect](https://www.domaintools.com/products/iris-detect/) to alert on newly registered lookalike and typosquatting domains, WHOIS record modifications on registered domains, and domain transfer attempts indicative of adversarial domain hijacking preparation activity.
- **Manage domain expiry proactively:** Implement automated domain renewal processes and monitoring to prevent inadvertent domain expiry, as expired domains can be re-registered by adversaries and used as convincing phishing infrastructure leveraging the historical trust reputation of the original domain.

***

## Detection Strategy

### Passive Collection Visibility Limitations

Domain property reconnaissance is predominantly conducted through passive queries against WHOIS databases, public DNS services, and certificate transparency logs, none of which generate network-level artefacts within the target organisation's infrastructure.  Conventional perimeter monitoring tools have no visibility into adversarial WHOIS lookups or DNS queries conducted from external infrastructure, and the high baseline volume of legitimate domain lookup activity generates significant false positive rates for any detection approach targeting these behaviours. As a result, direct detection of domain property reconnaissance activity is largely not achievable.

### Cloud Identity API and DNS Anomaly Detection

The most detectable active collection vector within this sub-technique involves the enumeration of Microsoft Entra ID tenant domains through unauthenticated API queries. Inbound requests to the `GetUserRealm`, `AutoDiscover`, and `GetCredentialType` endpoints from external IP addresses can be captured within **Microsoft Entra ID sign-in logs** and **Unified Audit Logs**, and forwarded to a **SIEM platform** such as [Splunk](https://www.splunk.com/) or [Microsoft Sentinel](https://azure.microsoft.com/en-us/products/microsoft-sentinel) for correlation and anomaly detection.  High-frequency or sequential API queries from a single external source IP, particularly those testing multiple domain name variants, should be flagged for investigation and source IPs enriched via threat intelligence services such as [AbuseIPDB](https://www.abuseipdb.com/) and [VirusTotal](https://www.virustotal.com/).
### Detection Pivot to Initial Access Indicators

Given the limited direct detection surface available during the reconnaissance phase, defenders should focus monitoring resources on the **Initial Access** and **Resource Development** stages at which collected domain intelligence is operationally applied. Indicators include the registration of lookalike domains detected through domain monitoring services, spearphishing campaigns originating from domains closely resembling the organisation's registered domain names, and exploitation attempts against services hosted on enumerated subdomains or domain-associated infrastructure.
