# Gather Victim Network Information

Gather Victim Network Information is a reconnaissance technique classified under **MITRE ATT&CK T1590** in which adversaries collect detailed intelligence about the network architecture, addressing, and operational dependencies of a target organisation to inform and support subsequent attack planning.  Network-level intelligence may encompass administrative data such as allocated IP ranges, registered domain names, and DNS record structures, as well as more granular operational details including network topology, routing configurations, deployed security appliances, trust relationships, and the identification of critical network infrastructure components. 

Adversaries gather this intelligence through a combination of active collection methods, including **Active Scanning (T1595)** and **Phishing for Information (T1598)**, and passive methods leveraging publicly accessible data sources such as **Search Open Technical Databases (T1596)**, regional internet registry (RIR) databases, and network mapping platforms.  The intelligence gathered can directly inform further reconnaissance activities (e.g., **T1595 – Active Scanning**, **T1593 – Search Open Websites/Domains**), resource development operations (e.g., **T1583 – Acquire Infrastructure**, **T1584 – Compromise Infrastructure**), and initial access attempts leveraging trusted network relationships (e.g., **T1199 – Trusted Relationship**). 

***

## Collection Vectors

Adversaries employ a broad range of passive and active collection methods to enumerate victim network information:

- **RIR and WHOIS Database Queries:** Regional Internet Registries including **ARIN**, **RIPE NCC**, **APNIC**, **LACNIC**, and **AFRINIC** maintain publicly queryable databases of allocated IP address blocks, autonomous system numbers (ASNs), and associated organisational details. Adversaries query these registries to enumerate the complete IP address space allocated to a target organisation, identifying all externally routable address ranges as a precursor to systematic scanning operations. Tools such as [Amass](https://github.com/owasp-amass/amass) and [ASNmap](https://github.com/projectdiscovery/asnmap) automate ASN-to-IP range resolution to rapidly scope the full external IP footprint of a target organisation.
- **DNS Enumeration:** Active and passive DNS reconnaissance enables adversaries to map the target's domain infrastructure, including subdomain structures, mail server configurations, name server assignments, and third-party service integrations. Tools such as [dnsx](https://github.com/projectdiscovery/dnsx), [Subfinder](https://github.com/projectdiscovery/subfinder), [Amass](https://github.com/owasp-amass/amass), and [MassDNS](https://github.com/blechschmidt/massdns) automate large-scale DNS enumeration, while passive DNS databases such as [SecurityTrails](https://securitytrails.com/) and [RiskIQ PassiveTotal](https://community.riskiq.com/) expose historical DNS record changes without any direct interaction with the target.
- **Internet Scan Database Querying:** Platforms including [Shodan](https://www.shodan.io/), [Censys](https://censys.io/), and [FOFA](https://fofa.info/) provide indexed scan results for internet-facing infrastructure, enabling adversaries to identify active hosts, open ports, exposed services, and network device types across the target's IP ranges without conducting direct scans.
- **Network Topology Mapping:** Post-compromise or through exposed management interfaces, adversaries use network discovery tools to map internal topology, enumerate subnets, identify routing configurations, and discover VMware vCenter or hypervisor management platforms that provide consolidated visibility into the entire virtual infrastructure.
- **Publicly Available Network Documentation:** Network architecture diagrams, assessment reports, and infrastructure documentation inadvertently published or leaked through employee profiles, job postings, and procurement records can expose detailed network topology, device inventories, and segmentation configurations.

***

## Procedure Examples

### HAFNIUM
**HAFNIUM** is a Chinese state-sponsored APT group primarily known for its exploitation of **Microsoft Exchange Server** zero-day vulnerabilities (ProxyLogon). As part of its pre-compromise reconnaissance operations, HAFNIUM collected **fully qualified domain names (FQDNs)** for targeted Exchange servers within victim environments, using this network intelligence to precisely scope and direct its exploitation campaigns against specific, reachable Exchange infrastructure rather than conducting broad, noisy scanning operations. 

### Indrik Spider (Evil Corp)
**Indrik Spider** is a financially motivated Russian cybercriminal group responsible for deploying ransomware families including **BitPaymer**, **WastedLocker**, and **Hades** against high-value enterprise targets in a **Big Game Hunting (BGH)** operational model.  Following initial compromise, the group downloaded and deployed the **Advanced Port Scanner** utility alongside [Lansweeper](https://www.lansweeper.com/), a network inventory and IT asset management tool, to conduct systematic internal network reconnaissance.  **Lansweeper** enables agentless network scanning without requiring credentials, returning detailed information about all discovered hosts including IP addresses, MAC addresses, device type, operating system, software inventory, and open ports.  The group additionally accessed the victim's **VMware vCenter** management console, which provided a consolidated and authoritative inventory of all virtualised hosts, cluster configurations, resource allocations, and network mappings across the virtual infrastructure, significantly accelerating lateral movement planning and ransomware deployment scoping. 

### Volt Typhoon
**Volt Typhoon** conducted extensive pre-compromise network reconnaissance against targeted critical national infrastructure organisations, leveraging publicly accessible tools and platforms to map external network topology, identify internet-facing infrastructure, and enumerate network addressing before initiating intrusion operations.  Consistent with its **Living Off the Land (LotL)** operational philosophy, Volt Typhoon used built-in Windows utilities including `netsh`, `ipconfig`, `net`, `ping`, and `tracert` to enumerate network configuration, routing tables, and connectivity from within compromised endpoints, deliberately avoiding the introduction of third-party tooling that would generate EDR detection artefacts.  The group also routed command and control traffic through compromised **Small Office/Home Office (SOHO) network devices** including routers, firewalls, and VPN appliances to blend malicious traffic with legitimate network activity and obscure the true origin of reconnaissance operations. 

***

## Mitigations: Pre-Compromise (MITRE M1056)

Network information reconnaissance operates through publicly accessible data sources and, post-compromise, through native network enumeration utilities, placing external collection activity largely outside the reach of conventional enterprise perimeter controls.  Mitigation efforts should focus on minimising the network intelligence available to external parties and hardening internal environments against post-compromise enumeration: 

- **Minimise external network information disclosure:** Conduct regular audits of publicly accessible information sources to identify and remediate inadvertent disclosures of network architecture details, IP range assignments, and domain structure information. Ensure that network documentation, architecture diagrams, and assessment reports are classified appropriately and never exposed through public-facing repositories or employee-published materials.
- **Implement network segmentation and access controls:** Enforce strict **network segmentation** using VLANs, firewall rules, and **zero trust network access (ZTNA)** principles to limit the blast radius of post-compromise enumeration. Restrict internal network discovery tools and protocols (e.g., SNMP, mDNS, LLMNR, NetBIOS Name Service) to authorised management systems and management VLANs only. Solutions such as [Zscaler Private Access](https://www.zscaler.com/products/zscaler-private-access) and [Cloudflare Zero Trust](https://www.cloudflare.com/en-gb/zero-trust/) enforce identity and device-based access policies that limit lateral discovery capabilities.
- **Restrict and monitor management interface exposure:** Ensure that network management platforms including **VMware vCenter**, **Cisco DNA Center**, hypervisor management consoles, and network inventory tools such as [Lansweeper](https://www.lansweeper.com/) are never exposed to the public internet and are accessible only from authorised management hosts on isolated management VLANs protected by multi-factor authentication. 
- **SOHO device security for remote workers:** Implement security standards and monitoring coverage for employee SOHO network devices used for remote work access, given the documented exploitation of these devices by **Volt Typhoon** as network reconnaissance and C2 proxying infrastructure. Consider deploying enterprise-grade endpoint management and **DNS filtering** solutions such as [Cisco Umbrella](https://umbrella.cisco.com/) to cover remote work environments.
- **Proactive external attack surface management:** Continuously monitor the organisation's external network footprint using **External Attack Surface Management (EASM)** platforms such as [Microsoft Defender External Attack Surface Management](https://www.microsoft.com/en-us/security/business/endpoint-security/microsoft-defender-external-attack-surface-management), [Censys ASM](https://censys.io/), and [Cortex Xpanse](https://www.paloaltonetworks.com/cortex/xpanse) to identify and remediate unintended network exposures before they can be enumerated by adversaries.

***

## Detection Strategy

### External Collection Visibility Limitations

The majority of external network information gathering operates through entirely passive collection against public data sources including RIR databases, DNS record queries, and internet scan platform indexing, generating no network-level artefacts within the target organisation's infrastructure.  As such, direct detection of pre-compromise network reconnaissance through conventional perimeter monitoring is largely not achievable, and detection resources are most productively directed toward observable downstream activity. 

### Post-Compromise Internal Enumeration Detection

The highest-fidelity detection opportunities arise when adversaries conduct internal network enumeration following initial access, at which point tooling deployment and network discovery traffic become observable within the target environment. Defenders should implement monitoring controls targeting the following indicators:

- **Deployment of network discovery utilities** including `Advanced Port Scanner`, `Lansweeper`, `Nmap`, and `nbtscan` onto endpoints outside of authorised IT management workflows, detectable through **EDR telemetry** from platforms such as [CrowdStrike Falcon](https://www.crowdstrike.com/) and [Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/security/business/endpoint-security/microsoft-defender-endpoint) monitoring process creation events. 
- **Anomalous vCenter or hypervisor management console access**, including authentication from unexpected source hosts, service accounts, or geographic locations, detectable through **vCenter audit logs** forwarded to a centralised **SIEM platform** such as [Splunk](https://www.splunk.com/) or [Microsoft Sentinel](https://azure.microsoft.com/en-us/products/microsoft-sentinel).
- **Unusual internal network scanning traffic**, including ICMP sweep activity, high-frequency ARP requests, or sequential port scanning patterns originating from endpoint hosts rather than authorised network management systems, detectable through **network flow analysis** tools such as [Zeek](https://zeek.org/) and [Suricata](https://suricata.io/).
- **Execution of built-in LotL network enumeration commands** (e.g., `netsh`, `ipconfig /all`, `arp -a`, `net view`, `tracert`) from unexpected processes or user accounts, detectable through **Windows Event Logging**, **Sysmon** process creation events (Event ID 1), and **command-line argument auditing** correlated within the SIEM environment. 
