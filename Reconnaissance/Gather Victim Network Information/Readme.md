***

# Gather Victim Network Information

Gather Victim Network Information is a reconnaissance technique classified under **MITRE ATT&CK T1590** in which adversaries collect detailed intelligence about the network architecture, addressing schemes, and operational dependencies of a target organisation to support subsequent attack planning and execution.  Network-level intelligence encompasses both administrative data, such as allocated IP address ranges, registered domain names, and DNS record structures, as well as more granular operational details including network topology, routing configurations, deployed security appliances, inter-organisational trust relationships, and the identification of critical network infrastructure components. 

Adversaries gather this intelligence through a combination of active collection methods, including **Active Scanning (T1595)** and **Phishing for Information (T1598)**, and passive methods leveraging publicly accessible data sources such as **Search Open Technical Databases (T1596)**, regional internet registry (RIR) databases, and internet scan indexing platforms.  The intelligence gathered can directly inform further reconnaissance activities (e.g., **T1595 – Active Scanning**, **T1593 – Search Open Websites/Domains**), resource development operations (e.g., **T1583 – Acquire Infrastructure**, **T1584 – Compromise Infrastructure**), and initial access attempts leveraging trusted network relationships (e.g., **T1199 – Trusted Relationship**). 

***

## Procedure Examples

### HAFNIUM
**HAFNIUM** is a Chinese state-sponsored APT group primarily known for its exploitation of **Microsoft Exchange Server** zero-day vulnerabilities (ProxyLogon: CVE-2021-26855, CVE-2021-26857, CVE-2021-26858, CVE-2021-27065). As part of its pre-compromise reconnaissance operations, HAFNIUM collected **fully qualified domain names (FQDNs)** for targeted Exchange servers within victim environments, using this network intelligence to precisely scope and direct exploitation campaigns against specific, reachable Exchange infrastructure rather than conducting broad, noisy scanning operations. 

### Indrik Spider (Evil Corp)
**Indrik Spider** is a financially motivated Russian cybercriminal group responsible for deploying ransomware families including **BitPaymer**, **WastedLocker**, and **Hades** against high-value enterprise targets in a **Big Game Hunting (BGH)** operational model.  Following initial access, the group deployed the **Advanced Port Scanner** utility alongside [Lansweeper](https://www.lansweeper.com/), a network inventory and IT asset management platform, to conduct systematic internal network reconnaissance.  Lansweeper performs agentless network scanning and returns comprehensive host inventories including IP addresses, MAC addresses, device types, operating system versions, software inventories, and open port listings.  The group additionally accessed the victim's **VMware vCenter** management console, which provided a consolidated and authoritative inventory of all virtualised hosts, cluster configurations, resource allocations, and network mappings across the entire virtual infrastructure, significantly accelerating lateral movement planning and ransomware deployment scoping. 

### Volt Typhoon
**Volt Typhoon** conducted extensive pre-compromise network reconnaissance against targeted critical national infrastructure organisations, leveraging publicly accessible platforms to map external network topology and enumerate internet-facing infrastructure before initiating intrusion operations.  Consistent with its **Living Off the Land (LotL)** operational philosophy, the group used built-in Windows utilities including `netsh`, `ipconfig`, `net`, `ping`, and `tracert` to enumerate internal network configurations, routing tables, and host connectivity from within compromised endpoints, deliberately avoiding the introduction of third-party tooling that would generate EDR detection artefacts. 

***

## Mitigations: Pre-Compromise (MITRE M1056)

Network information reconnaissance operates through publicly accessible data sources and, post-compromise, through native network enumeration utilities, placing external collection activity largely outside the reach of conventional enterprise perimeter controls.  Mitigation efforts should focus on minimising the network intelligence available to external parties and hardening internal environments against post-compromise enumeration: 

- **Minimise external network information disclosure:** Conduct regular audits of publicly accessible information sources including job postings, employee profiles, corporate websites, and procurement records to identify and remediate inadvertent disclosures of network architecture details, IP range assignments, and domain structure information.
- **Implement network segmentation and zero trust access:** Enforce strict network segmentation using VLANs, firewall policies, and **Zero Trust Network Access (ZTNA)** principles to limit lateral discovery capabilities following initial compromise. Solutions such as [Zscaler Private Access](https://www.zscaler.com/products/zscaler-private-access) and [Cloudflare Zero Trust](https://www.cloudflare.com/en-gb/zero-trust/) enforce identity and device-based access policies that constrain internal enumeration scope.
- **Restrict and monitor management interface exposure:** Ensure network management platforms including **VMware vCenter**, hypervisor consoles, and network inventory tools such as [Lansweeper](https://www.lansweeper.com/) are accessible exclusively from authorised management hosts on isolated management VLANs protected by multi-factor authentication.
- **Proactive external attack surface management:** Continuously monitor the organisation's external network footprint using **External Attack Surface Management (EASM)** platforms such as [Microsoft Defender EASM](https://www.microsoft.com/en-us/security/business/endpoint-security/microsoft-defender-external-attack-surface-management), [Censys ASM](https://censys.io/), and [Cortex Xpanse](https://www.paloaltonetworks.com/cortex/xpanse) to identify and remediate unintended network exposures before adversaries can enumerate them.

***

## Detection Strategy

Much of this reconnaissance activity occurs through passive collection against public data sources, generating no observable artefacts within the target organisation's infrastructure.  Detection resources yield the highest return when focused on post-compromise internal enumeration activity and downstream Initial Access indicators. Defenders should monitor for: 

- **Deployment of network discovery utilities** such as Advanced Port Scanner, Lansweeper, Nmap, and nbtscan outside authorised IT management workflows, detectable through **EDR telemetry** from platforms such as [CrowdStrike Falcon](https://www.crowdstrike.com/) and [Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/security/business/endpoint-security/microsoft-defender-endpoint). 
- **Anomalous vCenter or hypervisor management console access** from unexpected source hosts or accounts, detectable through management platform audit logs forwarded to a **SIEM** such as [Splunk](https://www.splunk.com/) or [Microsoft Sentinel](https://azure.microsoft.com/en-us/products/microsoft-sentinel).
- **Execution of LotL network enumeration commands** (e.g., `netsh`, `ipconfig /all`, `arp -a`, `net view`, `tracert`) from unexpected processes or user accounts, detectable through **Sysmon** process creation events (Event ID 1) and **Windows Event Log** command-line auditing. 

***

## Sub-Techniques

| Sub-Technique | Key Intelligence Collected | Common Collection Tools | Mitigations and Detection Focus |
|---|---|---|---|
| **Domain Properties** | Domain registrar details, administrative contact information, name server configurations, registration and expiry dates | [DomainTools](https://www.domaintools.com/), [WhoisXML API](https://www.whoisxmlapi.com/), [who.is](https://who.is/), RIR WHOIS databases | Enable WHOIS privacy protection; deploy domain monitoring via [RiskIQ](https://www.microsoft.com/en-us/security/business/siem-and-xdr/microsoft-defender-threat-intelligence) and [DomainTools Iris Detect](https://www.domaintools.com/products/iris-detect/) to alert on lookalike registrations and record changes  [attack.mitre](https://attack.mitre.org/techniques/T1590/001/) |
| **DNS**  | A, AAAA, MX, TXT, SPF, CNAME, NS records; subdomain structures; mail infrastructure; third-party SaaS service integrations (Office 365, G Suite, Salesforce) | [dnsx](https://github.com/projectdiscovery/dnsx), [Subfinder](https://github.com/projectdiscovery/subfinder), [Amass](https://github.com/owasp-amass/amass), [MassDNS](https://github.com/blechschmidt/massdns), [SecurityTrails](https://securitytrails.com/), [RiskIQ PassiveTotal](https://community.riskiq.com/) | Enable DNSSEC; restrict DNS zone transfer (AXFR) permissions; monitor DNS anomalies via [Cisco Umbrella](https://umbrella.cisco.com/); regularly audit and remove stale DNS records  [attack.mitre](https://attack.mitre.org/techniques/T1590/002/) |
| **Network Trust Dependencies** | Third-party MSP and vendor network access relationships, supply chain connectivity, federated trust configurations | OSINT collection from corporate websites, partner directories, government contractor registries, and professional network profiles | Enforce least-privilege third-party network access; conduct regular supplier security assessments; implement NAC solutions such as [Cisco ISE](https://www.cisco.com/c/en/us/products/security/identity-services-engine/index.html); maintain a current register of all trusted third-party network connections  [attack.mitre](https://attack.mitre.org/techniques/T1590/003/) |
| **Network Topology** | Physical and logical network segmentation, subnet layouts, routing configurations, VLAN structures, locations of domain controllers, databases, and OT/ICS systems | SNMP queries against exposed interfaces, leaked architecture diagrams, post-compromise LotL utilities (`netsh`, `arp`, `tracert`), [Nmap](https://nmap.org/) | Deploy micro-segmentation via [Illumio Core](https://www.illumio.com/) and [Akamai Guardicore](https://www.akamai.com/products/guardicore-segmentation); restrict SNMP to management VLANs; store network documentation exclusively in access-controlled internal repositories  [attack.mitre](https://attack.mitre.org/techniques/T1590/004/) |
| **IP Addresses** | Allocated IP ranges and ASN assignments, active hosts, hosting provider relationships, geographic distribution of infrastructure | [ASNmap](https://github.com/projectdiscovery/asnmap), [BGP.he.net](https://bgp.he.net/), [ipinfo.io](https://ipinfo.io/), [Shodan](https://www.shodan.io/), [Censys](https://censys.io/), [FOFA](https://fofa.info/) | Proactively scan own IP ranges via [Tenable.io](https://www.tenable.com/products/tenable-io) and [Qualys VMDR](https://www.qualys.com/apps/vulnerability-management-detection-response/); enforce strict firewall ingress filtering; decommission unused address space to reduce enumerable attack surface  [attack.mitre](https://attack.mitre.org/techniques/T1590/) |
| **Network Security Appliances** | Firewall, WAF, NIDS/NIPS, proxy, and bastion host vendor identities, product versions, and deployment configurations | Job posting and LinkedIn OSINT, [Shodan](https://www.shodan.io/), [Censys](https://censys.io/), fingerprinting of exposed management portal login pages | Suppress vendor and version information from appliance management portals; isolate management interfaces on dedicated VLANs; maintain structured firmware patch management; subscribe to vendor security advisories from [Fortinet PSIRT](https://www.fortiguard.com/psirt), [Palo Alto Networks](https://security.paloaltonetworks.com/), and [Cisco Security](https://www.cisco.com/c/en/us/support/web/tsd-products-field-notice-summary.html)  [attack.mitre](https://attack.mitre.org/techniques/T1590/006/) |
